---
layout: default
title: SSL Certificate Management in UTMStack
---

# SSL Certificate Management in UTMStack

This guide provides comprehensive steps on installing, generating, and renewing SSL certificates for UTMStack.

- [SSL Certificate Management in UTMStack](#ssl-certificate-management-in-utmstack)
  - [Manual SSL Certificate Installation](#manual-ssl-certificate-installation)
  - [Generate SSL with Certbot in UTMStack without DNS Change](#generate-ssl-with-certbot-in-utmstack-without-dns-change)
  - [Renew the Certificate Generated by Certbot in UTMStack](#renew-the-certificate-generated-by-certbot-in-utmstack)

## Manual SSL Certificate Installation

Before beginning, ensure you've downloaded your certificate files. After downloading:

1. You should have:
   - A certificate file with the extension `.crt` or `.pem`
   - A private key with the extension `.key` or `.pem`
   
2. Rename the files:
   - Certificate: `utm.crt`
   - Private Key: `utm.key`
   
3. Transfer both files to your server:

```bash
   mv utm.crt /utmstack/cert/
   mv utm.key /utmstack/cert/
```

4. Restart Docker for the changes to take effect:

```bash
systemctl restart docker
```

5. Allow approximately 10 minutes for the stack to restart.

{:note}
Once these steps are completed, your SSL certificate will be installed and configured for UTMStack. For any issues or questions during the installation, please contact our support team.

## Generate SSL with Certbot in UTMStack without DNS Change
1. Allow Necessary Ports
    Open ports for Certbot and Nginx:

```
ufw allow 80/tcp
ufw allow 443/tcp
ufw allow 1194/tcp
ufw reload
```

2. Install Certbot
Install the necessary tools and dependencies:
```
sudo apt install certbot python3-certbot-nginx
```

3. Manage Services
Stop Nginx and frontend services:

```
systemctl stop nginx
docker stop frontend
docker ps | grep frontend
```
Then, start Nginx:

```
systemctl start nginx
```
1. Generate SSL Certificate
Replace "siem.domain.com" with your domain:

```
sudo certbot --nginx -d siem.domain.com
```

5. Update SSL Certificate in UTMStack

```
systemctl stop nginx
systemctl disable nginx
cp /etc/letsencrypt/live/*/fullchain.pem /utmstack/cert/utm.crt
cp /etc/letsencrypt/live/*/privkey.pem /utmstack/cert/utm.key
systemctl stop docker
systemctl start docker
```

## Renew the Certificate Generated by Certbot in UTMStack

1. Manage Frontend Service
   
```
docker stop frontend
```

2. Start Nginx

```
systemctl start nginx
```

3. Renew SSL Certificate

```
certbot renew
```

4. Update SSL Certificate in UTMStack

Replace "siem.domain.com" with your specific domain:

```
systemctl stop nginx
systemctl disable nginx
cp /etc/letsencrypt/live/siem.domain.com/fullchain.pem /utmstack/cert/utm.crt
cp /etc/letsencrypt/live/siem.domain.com/privkey.pem /utmstack/cert/utm.key
systemctl stop docker
systemctl start docker
```

