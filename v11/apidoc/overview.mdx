## Introduction

The UTMStack API provides comprehensive access to security operations and alert management functionality. This documentation covers all available endpoints for integrating with UTMStack programmatically.

<Note>
All API endpoints require authentication via Bearer tokens. See the [Authentication](/v10/apidoc/authentication) section for details on obtaining access tokens.
</Note>

---

## API Base URL

The UTMStack API is available at:

```
https://your-utmstack-instance.com/api
```

<Warning>
Replace `your-utmstack-instance.com` with your actual UTMStack instance URL.
</Warning>

---

## Quick Start Guide

Get up and running with the UTMStack API in just a few steps:

  ### Authenticate

    Use your UTMStack credentials to obtain a JWT token
    ```bash
    curl -X POST https://your-utmstack-instance.com/api/authenticate \
      -H "Content-Type: application/json" \
      -d '{"username":"your_username","password":"your_password"}'
    ```
  ### Store Token

    Save the returned `id_token` for use in subsequent requests
    ```json
    {
      "id_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "authenticated": true
    }
    ```
  ### Make API Calls

    Use the token in the Authorization header for protected endpoints
    ```bash
    curl -X POST "https://your-utmstack-instance.com/api/elasticsearch/search" \
      -H "Authorization: Bearer YOUR_TOKEN_HERE" \
      -H "Content-Type: application/json"
    ```
---

## Available Endpoints

<CardGroup cols={2}>
  <Card title="Authentication" icon="pi pi-lock" iconAlign="left" href="/v10/apidoc/authentication" content="Obtain JWT tokens for API access" />
  
  <Card title="List Alerts" icon="pi pi-magnifying-glass" iconAlign="left" href="/v10/apidoc/alerts-list" content="Search and retrieve alerts with filtering" />
  
  <Card title="Update Status" icon="pi pi-refresh" iconAlign="left" href="/v10/apidoc/update-status" content="Change alert status (Open, In Review, Completed)" />
  
  <Card title="Update Tags" icon="pi pi-tags" iconAlign="left" href="/v10/apidoc/update-tags" content="Add or modify alert tags and create rules" />
  
  <Card title="Update Notes" icon="pi pi-note-sticky" iconAlign="left" href="/v10/apidoc/update-notes" content="Add investigation notes to alerts" />
  
  <Card title="Convert to Incident" icon="pi pi-exclamation-triangle" iconAlign="left" href="/v10/apidoc/convert-incident" content="Convert alerts into security incidents" />
  
  <Card title="Count Alerts" icon="pi pi-calculator" iconAlign="left" href="/v10/apidoc/count-alerts" content="Get count of open alerts for dashboards" />
  
  <Card title="Property Values" icon="pi pi-chart-bar" iconAlign="left" href="/v10/apidoc/property-values" content="Analyze field values and their distributions" />
  
  <Card title="CSV Export" icon="pi pi-download" iconAlign="left" href="/v10/apidoc/csv-export" content="Export alert data to CSV for reporting" />
---

## üì¶ Postman Collection

Get started quickly by importing our complete Postman collection that includes all API endpoints with pre-configured examples, authentication, and test scripts.

<Card title="Download UTMStack Alerts API Collection" icon="pi pi-download" iconAlign="left" href="/images/downloads/postman.json" content="**Complete Postman Collection (JSON)**     Includes all 9 API endpoints with examples, authentication setup, and automated tests.      <br/>      **What's included:**   - üîê JWT authentication with automatic token management   - üìã Pre-configured examples for all endpoints   - üß™ Automated test scripts for response validation   - üìä Multiple scenarios for each API call   - üîß Environment variables for easy configuration      <Tip>   **Download Tip**: If your browser displays the JSON instead of downloading it, right-click the link above and select &quot;Save link as...&quot; to save the file to your computer.   </Tip>" />

### How to Import

  ### Download Collection

    Click the download link above to get the JSON file
  ### Open Postman

    Launch Postman application or visit [web.postman.co](https://web.postman.co)
  ### Import Collection

    - Click "Import" button in Postman
    - Select "Upload Files" 
    - Choose the downloaded JSON file
    - Click "Import"
  ### Configure Environment

    Set up collection variables:
    - `baseUrl`: Your UTMStack instance URL
    - `bearerToken`: Will be set automatically after authentication
    - `alertId`: Sample alert ID for testing
  ### Start Testing

    Run the "Authentication" request first, then explore other endpoints
<Tip>
**Pro Tip:** The collection includes pre-request scripts that automatically handle authentication token management. Just run the authentication request once, and all other requests will use the token automatically.
</Tip>

---

## Authentication Overview

All API requests (except the authentication endpoint itself) require a valid Bearer token in the Authorization header:

```http
Authorization: Bearer <your_jwt_token>
```

### Quick Start Example

```bash Authenticate
curl -X POST https://your-utmstack-instance.com/api/authenticate \
  -H "Content-Type: application/json" \
  -d '{"username":"your_username","password":"your_password"}'
```

```json Authentication Response
{
  "id_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VybmFtZSIsImF1dGgiOiJST0xFX0FETUlOIn0.signature",
  "authenticated": true
}
```

### Additional Language Examples

<CodeGroup>

```bash curl
# 1. Get authentication token
curl -X POST https://your-utmstack-instance.com/api/authenticate \
  -H "Content-Type: application/json" \
  -d '{"username":"your_username","password":"your_password"}'

# 2. Use token in requests
curl -X POST "https://your-utmstack-instance.com/api/elasticsearch/search?page=1&size=25&indexPattern=alert-*" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json" \
  -d '[{"field":"status","operator":"IS","value":2}]'
```

```javascript JavaScript
// 1. Authenticate and get token
const authResponse = await fetch('https://your-utmstack-instance.com/api/authenticate', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    username: 'your_username',
    password: 'your_password'
  })
});

const { id_token } = await authResponse.json();

// 2. Use token for API requests
const alertsResponse = await fetch('https://your-utmstack-instance.com/api/elasticsearch/search?page=1&size=25&indexPattern=alert-*', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${id_token}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify([
    { field: 'status', operator: 'IS', value: 2 }
  ])
});
```

</CodeGroup>

---

## Common Response Codes

<Accordion multiple={true}>
    <AccordionTab header="2xx Success Codes">

    - **200 OK**: Request completed successfully
    - **201 Created**: Resource created successfully
    - **204 No Content**: Request successful, no response body
  
  </AccordionTab>

    <AccordionTab header="4xx Client Error Codes">

    - **400 Bad Request**: Invalid request format or parameters
    - **401 Unauthorized**: Missing or invalid authentication token
    - **403 Forbidden**: Insufficient permissions for the requested operation
    - **404 Not Found**: Requested resource does not exist
    - **429 Too Many Requests**: Rate limit exceeded
  
  </AccordionTab>

    <AccordionTab header="5xx Server Error Codes">

    - **500 Internal Server Error**: Unexpected server error
    - **502 Bad Gateway**: Upstream service unavailable
    - **503 Service Unavailable**: Service temporarily unavailable
  
  </AccordionTab>
</Accordion>

---

## Request/Response Format

### Content Type

All API requests and responses use JSON format:

```http
Content-Type: application/json
```

### Request Structure

Most endpoints expect JSON in the request body:

```json
{
  "field": "value",
  "array": ["item1", "item2"],
  "nested": {
    "property": "value"
  }
}
```

### Response Structure

Successful responses typically return:

- **Search endpoints**: Array of objects
- **Update endpoints**: HTTP 200 with empty body
- **Error responses**: JSON object with error details

---

## Rate Limiting

<Info>
UTMStack implements rate limiting to ensure API stability. If you exceed the rate limit, you'll receive a `429 Too Many Requests` response.
</Info>

### Best Practices

- **Implement exponential backoff** for retries
- **Cache authentication tokens** instead of re-authenticating for each request
- **Batch operations** when possible to reduce API calls
- **Use appropriate page sizes** for search operations

---

## Error Handling

### Standard Error Response

```json
{
  "error": "Error description",
  "message": "Detailed error message",
  "timestamp": "2024-10-16T10:30:00.000Z",
  "status": 400
}
```

### Error Handling Example

<CodeGroup>

```javascript JavaScript
try {
  const response = await fetch('/api/utm-alerts/status', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(payload)
  });

  if (!response.ok) {
    const errorData = await response.json();
    throw new Error(`API Error ${response.status}: ${errorData.message}`);
  }

  console.log('Success!');
} catch (error) {
  console.error('Failed to update alert:', error.message);
  
  // Handle specific error codes
  if (error.message.includes('401')) {
    // Token expired, re-authenticate
    await refreshAuthToken();
  } else if (error.message.includes('429')) {
    // Rate limited, wait and retry
    await new Promise(resolve => setTimeout(resolve, 5000));
  }
}
```

```python Python
import requests
import time

def handle_api_request(url, payload, token):
    headers = {
        'Authorization': f'Bearer {token}',
        'Content-Type': 'application/json'
    }
    
    try:
        response = requests.post(url, json=payload, headers=headers)
        response.raise_for_status()
        return response
        
    except requests.exceptions.HTTPError as e:
        if e.response.status_code == 401:
            # Token expired, re-authenticate
            print("Token expired, please re-authenticate")
        elif e.response.status_code == 429:
            # Rate limited, wait and retry
            print("Rate limited, waiting before retry...")
            time.sleep(5)
        else:
            print(f"API Error {e.response.status_code}: {e.response.text}")
        raise e
```

</CodeGroup>

---

## SDK and Libraries

<Note>
Currently, UTMStack provides REST API endpoints. Community SDKs and libraries may be available for specific programming languages.
</Note>

### Recommended HTTP Clients

- **JavaScript**: `fetch`, `axios`
- **Python**: `requests`, `httpx`
- **Java**: `OkHttp`, `Apache HttpClient`
- **C#**: `HttpClient`
- **Go**: `net/http`
- **PHP**: `Guzzle`, `cURL`

---

## Support and Resources

<CardGroup cols={2}>
  <Card title="Support Portal" icon="pi pi-headset" iconAlign="left" href="https://support.utmstack.com" content="Get help with API integration and troubleshooting" />
  
  <Card title="Status Codes Reference" icon="pi pi-list-check" iconAlign="left" href="#common-response-codes" content="Complete list of HTTP status codes and meanings" />
  
  <Card title="Authentication Guide" icon="pi pi-key" iconAlign="left" href="/v10/apidoc/authentication" content="Detailed authentication setup and token management" />
  
  <Card title="Examples Repository" icon="pi pi-code" iconAlign="left" href="#" content="Sample code and integration examples" />
---

## Version Information

- **API Version**: v1.0
- **Documentation Version**: 2025.10
- **Last Updated**: October 2025

<Tip>
This documentation is actively maintained. Check back regularly for updates and new endpoint additions.
</Tip>